<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Code</title>
    <link rel="stylesheet" href="GreenCode.css">
    <link rel="icon" href="https://www.iconsdb.com/icons/preview/green/leaf-xxl.png" type="image/png">
</head>
<body>
    <!-- Tittel og brukerinfo -->
    <div class="navbar-top">
        <h1 class="logo">GreenCode</h1>
        <div id="user-info">
            <span id="user-name"></span>
            <span id="badge-container">Laster badges...</span>
            <a id="auth-btn" class="login-btn" href="#">Logg inn</a>
        </div>
    </div>

    <!-- Navigasjonsmeny -->
    <div class="navbar">
        <a href="index.html">Home</a>
        <div class="dropdown">
            <button class="dropbtn">Articles</button>
            <div class="dropdown-content">
                <a href="GreenCode-user-case-studies.html">User Case Studies</a>
                <a href="GreenCode-guides.html">Guides</a>
                <a href="GreenCode-checklist.html">Checklist</a>
                <a href="GreenCode-tutorials.html">Tutorials</a>
            </div>
        </div>
        
        <a href="GreenCode-carbonfootprint.html">Carbonfootprint</a>
        <a href="https://f0fd-128-39-132-236.ngrok-free.app">Forum</a>
        <div class="dropdown">
            <button class="dropbtn">Contact</button>
            <div class="dropdown-content">
                <a href="GreenCode-contactus.html">Contact Us</a>
                <a href="GreenCode-about-us.html">About Us</a>
            </div>
        </div> 
        
        <div class="dropdown">
            <button class="dropbtn">Badges & Challenges</button>
            <div class="dropdown-content">
                <a href="Code-Badges & Challenges.html">Badges</a>
                <a href="challenges.html">Challenges</a>
            </div>
        </div>
    </div>

    <!-- Bilder -->
    <img src="https://image.forskning.no/2128008.webp?imageId=2128008&width=2116&height=1208&format=webp" alt="fancy bilde" id="hovedbilde">
    
    <h2>What is Green Coding?</h2>
    <hr>
        <p>Green coding is known as green IT or sustainable IT, and aims to minimize the enviromental impact of IT operations.</p>
        <p>Historically, the focus has been on replacing hardware with more eco-friendly alternatives or recycling old equipment. However, software's role is increasingly recognized as a critical factor in reducing IT's carbon footprint.</p>
        <p>For example, inefficient coding practices or poorly optimized software can increase energy usage significantly. By prioritizing more efficient development practices, businesses can lower energy consumption and emissions while improving software performance and quality.</p>
    <hr>

    <footer>
        <p>&copy; 2025 GreenCode. All rights reserved.</p>
        <a href="GreenCode-guides.html">Guides</a>
        <a href="GreenCode-contactus.html">Contact Us</a>
    </footer>
    
    <script type="module">
        // Firebase importer
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCDtb0s8if31AXSdoIao_N4sIODaeVPM98",
            authDomain: "greencode-project-49744.firebaseapp.com",
            projectId: "greencode-project-49744",
            storageBucket: "greencode-project-49744.appspot.com",
            messagingSenderId: "728982263717",
            appId: "1:728982263717:web:dcd1f096d04cb52909fa4c",
            measurementId: "G-8FZXZ885MN"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Endre fra const til let for authBtn så vi kan oppdatere den senere
        let authBtn = document.getElementById("auth-btn");
        const badgeContainer = document.getElementById("badge-container");
        const userName = document.getElementById("user-name");

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const name = user.displayName || "Bruker";
                userName.textContent = `Hei, ${name}!`;

                authBtn.textContent = "Logg ut";
                authBtn.href = "#";
                
                // Fjern eventuelle tidligere event listeners før vi legger til ny
                const newAuthBtn = authBtn.cloneNode(true);
                authBtn.parentNode.replaceChild(newAuthBtn, authBtn);
                authBtn = newAuthBtn;
                
                authBtn.addEventListener("click", (e) => {
                    e.preventDefault();
                    signOut(auth);
                });

                try {
                    // Hent badges fra collection
                    const badgesRef = collection(db, "badges");
                    const querySnapshot = await getDocs(badgesRef);
                    
                    badgeContainer.innerHTML = "";  // Tøm badge-containeren før vi viser nye badges
                    
                    if (querySnapshot.empty) {
                        badgeContainer.textContent = "Ingen badges funnet";
                    } else {
                        querySnapshot.forEach((doc) => {
                            const badge = doc.data();
                            if (badge && badge.Ikon) {
                                // Opprett kun bildeelementet uten tekst
                                const img = document.createElement("img");
                                img.src = badge.Ikon;
                                img.alt = badge.Navn || 'Badge';
                                img.title = badge.Beskrivelse || ''; // Viser beskrivelsen som tooltip ved hover
                                img.style.width = "40px";
                                img.style.height = "40px";
                                img.style.marginLeft = "5px";
                                
                                // Legg til bildet direkte i container
                                badgeContainer.appendChild(img);
                            }
                        });
                    }
                } catch (error) {
                    console.error("Feil ved henting av badges:", error);
                    badgeContainer.textContent = "Kunne ikke laste badges";
                }
            } else {
                userName.textContent = "";
                badgeContainer.textContent = "";
                authBtn.textContent = "Logg inn";
                authBtn.href = "login.html";
            }
        });
    </script>
</body>
</html>